# Undertale PSP - Game Description

## Обзор игры

Undertale - это уникальная RPG игра, где игрок управляет ребенком, который упал в подземный мир монстров. Основная особенность игры - возможность проходить её без убийства врагов, используя систему "SPARE" (пощадить).

## Основные механики

### 1. Система боя

-   **Сердце (Heart)**: Игрок управляет красным сердцем в бою
-   **Уклонение**: Нужно уклоняться от разноцветных пуль
-   **SPARE**: Вместо атаки можно пощадить врага
-   **Диалоги**: Общение с врагами влияет на исход боя

### 2. Типы пуль

-   **Красные пули**: Нужно уклоняться
-   **Синие пули**: Нужно оставаться неподвижным
-   **Оранжевые пули**: Нужно двигаться

### 3. Система здоровья

-   Максимальное HP: 20
-   При получении урона HP уменьшается
-   При 0 HP - Game Over

## Структура игры

### 1. Главное меню

-   **START**: Начать новую игру
-   **CONTINUE**: Продолжить сохраненную игру
-   **EXIT**: Выход из игры

### 2. Игровые локации

-   **Ruins**: Начальная локация, встреча с Toriel
-   **Snowdin**: Лесная локация, встреча с Papyrus
-   **Waterfall**: Водопад, встреча с Undyne
-   **Hotland**: Лаборатория, встреча с Mettaton
-   **Final Area**: Финальная битва с Asgore

### 3. Система боя

-   **Battle Screen**: Экран боя с сердцем игрока
-   **Bullet Patterns**: Паттерны пуль от врагов
-   **SPARE System**: Система пощады врагов
-   **Dialog System**: Диалоги с врагами

## Управление

### В главном меню:

-   **D-Pad**: Навигация по меню
-   **X**: Подтверждение выбора
-   **START**: Выход из игры

### В бою:

-   **D-Pad**: Движение сердца
-   **X**: SPARE (пощадить)
-   **O**: FIGHT (атаковать)
-   **Triangle**: ITEM (использовать предмет)
-   **Square**: MERCY (меню милосердия)

### В диалогах:

-   **X**: Следующая строка диалога
-   **D-Pad**: Выбор варианта ответа

## Игровые экраны

### 1. Главное меню

-   Фон: Темный
-   Текст: "UNDERTALE" (большой шрифт)
-   Опции: START, CONTINUE, EXIT
-   Музыка: menu_theme.at3

### 2. Экран боя

-   Фон: Соответствует локации
-   UI: Рамка с информацией о бое
-   Сердце игрока: Красное, управляемое
-   Пульсы врага: Разноцветные
-   Диалог: Текст врага

### 3. Диалоговый экран

-   Фон: Темный
-   Текст: Диалог персонажа
-   UI: Рамка диалога

## Персонажи

### 1. Toriel (Ruins)

-   Спрайт: toriel.png / toriel_full.png
-   Музыка: ruins_theme.at3
-   Особенность: Легкий бой, учит механикам

### 2. Papyrus (Snowdin)

-   Спрайт: papyrus.png / papyrus_full.png
-   Музыка: snowdin_theme.at3
-   Особенность: Бой с синими и красными пулями

### 3. Undyne (Waterfall)

-   Спрайт: undyne.png / undyne_full.png
-   Музыка: waterfall_theme.at3
-   Особенность: Быстрые пули, сложные паттерны

### 4. Mettaton (Hotland)

-   Спрайт: mettaton.png / mettaton_full.png
-   Музыка: hotland_theme.at3
-   Особенность: Бой с оранжевыми пулями

### 5. Asgore (Final Area)

-   Спрайт: asgore.png / asgore_full.png
-   Музыка: final_battle.at3
-   Особенность: Финальный босс, все типы пуль

## Звуковые эффекты

-   **footsteps.wav**: Звук шагов
-   **battle_start.wav**: Начало боя
-   **heart_hurt.wav**: Получение урона
-   **spare_success.wav**: Успешная пощада
-   **dialog_next.wav**: Следующая строка диалога
-   **menu_select.wav**: Выбор в меню
-   **menu_confirm.wav**: Подтверждение в меню
-   **save_point.wav**: Сохранение
-   **game_over.wav**: Game Over
-   **item_pickup.wav**: Подбор предмета

## Техническая реализация

### Состояния игры:

1. **MENU**: Главное меню
2. **DIALOG**: Диалоговый экран
3. **BATTLE**: Экран боя
4. **GAME_OVER**: Экран окончания игры

### Основные функции:

-   `initGame()`: Инициализация игры
-   `updateMenu()`: Обновление главного меню
-   `updateBattle()`: Обновление боя
-   `updateDialog()`: Обновление диалогов
-   `drawBattle()`: Отрисовка боя
-   `drawMenu()`: Отрисовка меню
-   `handleInput()`: Обработка ввода

### Система пуль:

-   Каждая пуля имеет тип (красная, синяя, оранжевая)
-   Паттерны пуль задаются для каждого босса
-   Система коллизий для определения попаданий

### Система диалогов:

-   Диалоги хранятся в таблицах
-   Поддержка выбора вариантов ответа
-   Автоматическое переключение между диалогами и боем

## Особенности реализации

1. **Простота**: Игра адаптирована для PSP с упрощенными механиками
2. **Аутентичность**: Сохранен дух оригинальной игры
3. **Оптимизация**: Эффективное использование ресурсов PSP
4. **Управление**: Адаптировано под контроллер PSP
5. **Звук**: Полная поддержка музыки и звуковых эффектов

## Выход из игры

При нажатии START в главном меню:

1. Вызывается `USGAPI.unloadAll()` для очистки ресурсов
2. Игра завершается через `os.exit()`
